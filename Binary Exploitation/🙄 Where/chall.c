#include<stdio.h>
#include<string.h>
#include<stdlib.h>
#include<unistd.h>


#define MAX_NAMES 10
#define MAX_LENGTH 50

char names[10][50]={"Leia Kane","Briggs Decker","Kashton Valdez","Watson Edwards","Dilan McKenzie","Phillip Barton","Paxton Avery","Cassius Rosales","Jason Noble"};

void hehe(){
	FILE *f = fopen("./flag.txt", "r");
	if (f == NULL) {
	    printf("Cannot open flag.txt\n");
	    exit(1);
	}
	fgets(names[9], 50, f);
	fclose(f);
}

int readint(){
    char buf[0x10];
    return atoi(fgets(buf,0x10,stdin));
}

void init(){
	setvbuf(stdin, 0LL, 2, 0LL);
  	setvbuf(stdout, 0LL, 2, 0LL);
  	setvbuf(stderr, 0LL, 2, 0LL);
  	alarm(30);
  	hehe();
}

void view_names(int index) {
    if (index < 0 || index >= 9) {
        printf("Forbidden.\n");
    } else {
        printf("Names:\n");
        printf("%d. %s\n", index + 1, names[index]);
    }
}

void edit_name(int index, const char* new_name) {
    if (index < 0 || index >= 9) {
        printf("Forbidden.\n");
    } else {
        strncpy(names[index], new_name, strlen(new_name));
        printf("Name edited successfully.\n");
    }
}

void delete_name(int index) {
    if (index < 0 || index >= 9) {
        printf("Forbidden.\n");
    } else {
        memset(names[index], 0, MAX_LENGTH); 
        printf("Name deleted successfully.\n");
    }
}

int main() {

	init();
    int choice, index;
    char temp[0x100];

    while (1) {
        printf("\nMenu:\n");
        printf("1. View Names\n");
        printf("2. Edit Name\n");
        printf("3. Delete Name\n");
        printf("4. Exit\n");
        printf("Enter your choice: ");
        choice = readint();

        switch (choice) {
            case 1:
            	printf("Enter index of name to view: ");
                index = readint();
                view_names(index);
                break;
            case 2:
                printf("Enter index of name to edit: ");
                index = readint();
                printf("Enter new name: ");
                read(0,temp,MAX_LENGTH);
                edit_name(index, temp);
                break;
            case 3:
                printf("Enter index of name to delete: ");
                index = readint();
                delete_name(index);
                break;
            case 4:
                return 0;
            default:
                printf("Invalid choice. Please try again.\n");
        }
    }

    return 0;
}